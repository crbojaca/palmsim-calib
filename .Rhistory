", latitude = ", latitude,
", soil_depth = ", soil_depth,
", soil_texture_class = '", soil_texture, "')"))
# Couple the weather data
py_run_string("pf.weather.radiation_series = weather['solar (MJ/m2/day)']")
py_run_string("pf.weather.rainfall_series = weather['precip (mm/day)']")
py_run_string("pf.weather.temperature_series = weather['temperature (degC)']")
py_run_string("pf.weather.humidity_series = weather['humidity (%)']")
# Run the simulation
py_run_string(paste0("df = pf.run(duration = ",
as.integer(as.numeric(difftime(end_date, start_date, units = 'days'))), ")"))
df <- py$df
df$date <- ymd(df$date)
df$YAP <- df$YAP + (yday(df$date) / 365)
df$rendimiento_t_ha <- df$`generative_bunch_count_daily (1/ha/day)` * df$`generative_bunch_weight (kg)` / 1000
return(df)
}
sim_run <- palmsim(clima_path = "variedades_CEPV/ClimateData_Variedades_CEPV.csv",
start_date = ymd(20031001),
end_date = ymd(20191231),
density = 143,
dt = 1,
latitude = 6.98492,
soil_depth = 1.0,
soil_texture = "clay loam")
0.0022*0.8
palmsim <- function(clima_path, start_date, end_date, density = 143, dt = 1, latitude, soil_depth, soil_texture){
require(reticulate)
py_run_string("import pandas as pd")
py_run_string(paste("weather = pd.read_csv('", clima_path, "', index_col = 'Date')", sep = ""))
py_run_string("weather.index = pd.to_datetime(weather.index)")
py_run_string("from palmsim import PalmField")
py_run_string(paste0("pf = PalmField(year_of_planting = ", as.integer(year(start_date)),
", month_of_planting = ", as.integer(lubridate::month(start_date)),
", day_of_planting = ", as.integer(day(start_date)),
", planting_density = ", as.integer(density),
", dt = ", as.integer(dt),
", latitude = ", latitude,
", soil_depth = ", soil_depth,
", soil_texture_class = '", soil_texture, "')"))
# Couple the weather data
py_run_string("pf.weather.radiation_series = weather['solar (MJ/m2/day)']")
py_run_string("pf.weather.rainfall_series = weather['precip (mm/day)']")
py_run_string("pf.weather.temperature_series = weather['temperature (degC)']")
py_run_string("pf.weather.humidity_series = weather['humidity (%)']")
# Run the simulation
py_run_string(paste0("df = pf.run(duration = ",
as.integer(as.numeric(difftime(end_date, start_date, units = 'days'))), ")"))
df <- py$df
df$date <- ymd(df$date)
df$YAP <- df$YAP + (yday(df$date) / 365)
df$rendimiento_t_ha <- df$`generative_bunch_count_daily (1/ha/day)` * df$`generative_bunch_weight (kg)` / 1000
return(df)
}
sim_run <- palmsim(clima_path = "variedades_CEPV/ClimateData_Variedades_CEPV.csv",
start_date = ymd(20031001),
end_date = ymd(20191231),
density = 143,
dt = 1,
latitude = 6.98492,
soil_depth = 1.0,
soil_texture = "clay loam")
library(data.table)
# fwrite(sim_run, "variedades_CEPV/PALMSIM_output_modelo_original.csv")
fwrite(sim_run, "variedades_CEPV/PALMSIM_output_rootspecmaint0.00176.csv")
0.0022*1.2
palmsim <- function(clima_path, start_date, end_date, density = 143, dt = 1, latitude, soil_depth, soil_texture){
require(reticulate)
py_run_string("import pandas as pd")
py_run_string(paste("weather = pd.read_csv('", clima_path, "', index_col = 'Date')", sep = ""))
py_run_string("weather.index = pd.to_datetime(weather.index)")
py_run_string("from palmsim import PalmField")
py_run_string(paste0("pf = PalmField(year_of_planting = ", as.integer(year(start_date)),
", month_of_planting = ", as.integer(lubridate::month(start_date)),
", day_of_planting = ", as.integer(day(start_date)),
", planting_density = ", as.integer(density),
", dt = ", as.integer(dt),
", latitude = ", latitude,
", soil_depth = ", soil_depth,
", soil_texture_class = '", soil_texture, "')"))
# Couple the weather data
py_run_string("pf.weather.radiation_series = weather['solar (MJ/m2/day)']")
py_run_string("pf.weather.rainfall_series = weather['precip (mm/day)']")
py_run_string("pf.weather.temperature_series = weather['temperature (degC)']")
py_run_string("pf.weather.humidity_series = weather['humidity (%)']")
# Run the simulation
py_run_string(paste0("df = pf.run(duration = ",
as.integer(as.numeric(difftime(end_date, start_date, units = 'days'))), ")"))
df <- py$df
df$date <- ymd(df$date)
df$YAP <- df$YAP + (yday(df$date) / 365)
df$rendimiento_t_ha <- df$`generative_bunch_count_daily (1/ha/day)` * df$`generative_bunch_weight (kg)` / 1000
return(df)
}
sim_run <- palmsim(clima_path = "variedades_CEPV/ClimateData_Variedades_CEPV.csv",
start_date = ymd(20031001),
end_date = ymd(20191231),
density = 143,
dt = 1,
latitude = 6.98492,
soil_depth = 1.0,
soil_texture = "clay loam")
library(data.table)
# fwrite(sim_run, "variedades_CEPV/PALMSIM_output_modelo_original.csv")
fwrite(sim_run, "variedades_CEPV/PALMSIM_output_rootspecmaint0.00264.csv")
library(data.table)
library(Metrics)
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
##### Importar los datos #####
sim_init <- fread('variedades_CEPV/PALMSIM_output_modelo_original.csv') %>%
mutate(Parámetro = 'Original')
sim_alto_rtspmt <- fread('variedades_CEPV/PALMSIM_output_rootspecmaint0.00264.csv')%>%
mutate(Parámetro = 'Root specific maintenance = 0.00264')
sim_alto_rtspmt_1 <- fread('variedades_CEPV/PALMSIM_output_rootspecmaint0.00242.csv')%>%
mutate(Parámetro = 'Root specific maintenance = 0.00242')
sim_alto_rtspmt_2 <- fread('variedades_CEPV/PALMSIM_output_rootspecmaint0.22.csv')%>%
mutate(Parámetro = 'Root specific maintenance = 0.22')
sim_bajo_rtspmt <- fread('variedades_CEPV/PALMSIM_output_rootspecmaint0.00176.csv') %>%
mutate(Parámetro = 'Root specific maintenance = 0.00176')
sim_bajo_rtspmt_1 <- fread('variedades_CEPV/PALMSIM_output_rootspecmaint0.00198.csv') %>%
mutate(Parámetro = 'Root specific maintenance = 0.00198')
sim_bajo_rtspmt_2 <- fread('variedades_CEPV/PALMSIM_output_rootspecmaint0.0001.csv') %>%
mutate(Parámetro = 'Root specific maintenance = 0.0001')
sim_alto_mscfibpot <- fread('variedades_CEPV/PALMSIM_output_mesocarpfibpotmassfract0.28.csv')%>%
mutate(Parámetro = 'Mesocarp fiber potential mass fraction = 0.28')
sim_bajo_mscfibpot <- fread('variedades_CEPV/PALMSIM_output_mesocarpfibpotmassfract0.42.csv') %>%
mutate(Parámetro = 'Mesocarp fiber potential mass fraction = 0.42')
sim_alto_trkcnveff <- fread('variedades_CEPV/PALMSIM_output_trunkconveff0.828.csv')%>%
mutate(Parámetro = 'Trunk conversion efficiency = 0.828')
sim_bajo_trkcnveff <- fread('variedades_CEPV/PALMSIM_output_trunkconveff0.552.csv') %>%
mutate(Parámetro = 'Trunk conversion efficiency = 0.552')
sim_bajo_trkcnveff_1 <- fread('variedades_CEPV/PALMSIM_output_trunkconveff35.csv') %>%
mutate(Parámetro = 'Trunk conversion efficiency = 35')
sims <- rbind(sim_init, sim_alto_rtspmt, sim_bajo_rtspmt, sim_alto_mscfibpot, sim_bajo_mscfibpot,
sim_alto_rtspmt_1, sim_bajo_rtspmt_1, sim_alto_rtspmt_2, sim_bajo_rtspmt_2,
sim_alto_trkcnveff, sim_bajo_trkcnveff, sim_bajo_trkcnveff_1)
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
##### Grafico datos #####
sims_year <- sims %>%
group_by(Año = year(date), Parámetro) %>%
summarise(Rendimiento = sum(rendimiento_t_ha))
ggplot() +
geom_point(data = sims_year,
aes(x = Año, y = Rendimiento, color = Parámetro)) +
geom_line(data = sims_year,
aes(x = Año, y = Rendimiento, color = Parámetro)) +
labs(title = 'Variación de parámetros',
x = 'Año',
y = 'Rendimiento (t/ha)') +
theme_bw(base_size = 14,
base_family = 'Roboto Condensed') +
theme(legend.position = 'bottom',
legend.title = element_blank())
palmsim <- function(clima_path, start_date, end_date, density = 143, dt = 1, latitude, soil_depth, soil_texture){
require(reticulate)
py_run_string("import pandas as pd")
py_run_string(paste("weather = pd.read_csv('", clima_path, "', index_col = 'Date')", sep = ""))
py_run_string("weather.index = pd.to_datetime(weather.index)")
py_run_string("from palmsim import PalmField")
py_run_string(paste0("pf = PalmField(year_of_planting = ", as.integer(year(start_date)),
", month_of_planting = ", as.integer(lubridate::month(start_date)),
", day_of_planting = ", as.integer(day(start_date)),
", planting_density = ", as.integer(density),
", dt = ", as.integer(dt),
", latitude = ", latitude,
", soil_depth = ", soil_depth,
", soil_texture_class = '", soil_texture, "')"))
# Couple the weather data
py_run_string("pf.weather.radiation_series = weather['solar (MJ/m2/day)']")
py_run_string("pf.weather.rainfall_series = weather['precip (mm/day)']")
py_run_string("pf.weather.temperature_series = weather['temperature (degC)']")
py_run_string("pf.weather.humidity_series = weather['humidity (%)']")
# Run the simulation
py_run_string(paste0("df = pf.run(duration = ",
as.integer(as.numeric(difftime(end_date, start_date, units = 'days'))), ")"))
df <- py$df
df$date <- ymd(df$date)
df$YAP <- df$YAP + (yday(df$date) / 365)
df$rendimiento_t_ha <- df$`generative_bunch_count_daily (1/ha/day)` * df$`generative_bunch_weight (kg)` / 1000
return(df)
}
sim_run <- palmsim(clima_path = "variedades_CEPV/ClimateData_Variedades_CEPV.csv",
start_date = ymd(20031001),
end_date = ymd(20191231),
density = 143,
dt = 1,
latitude = 6.98492,
soil_depth = 1.0,
soil_texture = "clay loam")
library(data.table)
source("C:/Users/cbojaca/OneDrive - FEDEPALMA/palmsim-master/run_PALSIM_function.R", echo=TRUE)
library(data.table)
library(Metrics)
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
##### Importar los datos #####
sim_init <- fread('variedades_CEPV/PALMSIM_output_modelo_original.csv') %>%
mutate(Parámetro = 'Original')
sim_alto_rtspmt <- fread('variedades_CEPV/PALMSIM_output_rootspecmaint0.00264.csv')%>%
mutate(Parámetro = 'Root specific maintenance = 0.00264')
sim_alto_rtspmt_1 <- fread('variedades_CEPV/PALMSIM_output_rootspecmaint0.00242.csv')%>%
mutate(Parámetro = 'Root specific maintenance = 0.00242')
sim_alto_rtspmt_2 <- fread('variedades_CEPV/PALMSIM_output_rootspecmaint0.22.csv')%>%
mutate(Parámetro = 'Root specific maintenance = 0.22')
sim_bajo_rtspmt <- fread('variedades_CEPV/PALMSIM_output_rootspecmaint0.00176.csv') %>%
mutate(Parámetro = 'Root specific maintenance = 0.00176')
sim_bajo_rtspmt_1 <- fread('variedades_CEPV/PALMSIM_output_rootspecmaint0.00198.csv') %>%
mutate(Parámetro = 'Root specific maintenance = 0.00198')
sim_bajo_rtspmt_2 <- fread('variedades_CEPV/PALMSIM_output_rootspecmaint0.0001.csv') %>%
mutate(Parámetro = 'Root specific maintenance = 0.0001')
sim_alto_mscfibpot <- fread('variedades_CEPV/PALMSIM_output_mesocarpfibpotmassfract0.28.csv')%>%
mutate(Parámetro = 'Mesocarp fiber potential mass fraction = 0.28')
sim_bajo_mscfibpot <- fread('variedades_CEPV/PALMSIM_output_mesocarpfibpotmassfract0.42.csv') %>%
mutate(Parámetro = 'Mesocarp fiber potential mass fraction = 0.42')
sim_alto_trkcnveff <- fread('variedades_CEPV/PALMSIM_output_trunkconveff0.828.csv')%>%
mutate(Parámetro = 'Trunk conversion efficiency = 0.828')
sim_bajo_trkcnveff <- fread('variedades_CEPV/PALMSIM_output_trunkconveff0.552.csv') %>%
mutate(Parámetro = 'Trunk conversion efficiency = 0.552')
sim_bajo_trkcnveff_1 <- fread('variedades_CEPV/PALMSIM_output_trunkconveff35.csv') %>%
mutate(Parámetro = 'Trunk conversion efficiency = 35')
sims <- rbind(sim_init, sim_alto_rtspmt, sim_bajo_rtspmt, sim_alto_mscfibpot, sim_bajo_mscfibpot,
sim_alto_rtspmt_1, sim_bajo_rtspmt_1, sim_alto_rtspmt_2, sim_bajo_rtspmt_2,
sim_alto_trkcnveff, sim_bajo_trkcnveff, sim_bajo_trkcnveff_1)
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
##### Grafico datos #####
sims_year <- sims %>%
group_by(Año = year(date), Parámetro) %>%
summarise(Rendimiento = sum(rendimiento_t_ha))
ggplot() +
geom_point(data = sims_year,
aes(x = Año, y = Rendimiento, color = Parámetro)) +
geom_line(data = sims_year,
aes(x = Año, y = Rendimiento, color = Parámetro)) +
labs(title = 'Variación de parámetros',
x = 'Año',
y = 'Rendimiento (t/ha)') +
theme_bw(base_size = 14,
base_family = 'Roboto Condensed') +
theme(legend.position = 'bottom',
legend.title = element_blank())
source("C:/Users/cbojaca/OneDrive - FEDEPALMA/palmsim-master/run_PALSIM_function.R", echo=TRUE)
0.0022*0.8
0.0022*1.2
source("C:/Users/cbojaca/OneDrive - FEDEPALMA/palmsim-master/run_PALSIM_function.R", echo=TRUE)
library(data.table)
library(Metrics)
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
##### Importar los datos #####
sim_init <- fread('variedades_CEPV/PALMSIM_output_modelo_original.csv') %>%
mutate(Parámetro = 'Original')
sim_alto_rtspmt <- fread('variedades_CEPV/PALMSIM_output_rootspecmaint0.00264.csv')%>%
mutate(Parámetro = 'Root specific maintenance = 0.00264')
sim_bajo_rtspmt <- fread('variedades_CEPV/PALMSIM_output_rootspecmaint0.00176.csv') %>%
mutate(Parámetro = 'Root specific maintenance = 0.00176')
sim_alto_mscfibpot <- fread('variedades_CEPV/PALMSIM_output_mesocarpfibpotmassfract0.28.csv')%>%
mutate(Parámetro = 'Mesocarp fiber potential mass fraction = 0.28')
sim_bajo_mscfibpot <- fread('variedades_CEPV/PALMSIM_output_mesocarpfibpotmassfract0.42.csv') %>%
mutate(Parámetro = 'Mesocarp fiber potential mass fraction = 0.42')
sim_alto_trkcnveff <- fread('variedades_CEPV/PALMSIM_output_trunkconveff0.828.csv')%>%
mutate(Parámetro = 'Trunk conversion efficiency = 0.828')
sim_bajo_trkcnveff <- fread('variedades_CEPV/PALMSIM_output_trunkconveff0.552.csv') %>%
mutate(Parámetro = 'Trunk conversion efficiency = 0.552')
sims <- rbind(sim_init, sim_alto_rtspmt, sim_bajo_rtspmt, sim_alto_mscfibpot, sim_bajo_mscfibpot,
sim_alto_rtspmt_1, sim_bajo_rtspmt_1, sim_alto_rtspmt_2, sim_bajo_rtspmt_2,
sim_alto_trkcnveff, sim_bajo_trkcnveff, sim_bajo_trkcnveff_1)
sims <- rbind(sim_init, sim_alto_rtspmt, sim_bajo_rtspmt)
sim_init <- fread('variedades_CEPV/PALMSIM_output_modelo_original.csv') %>%
mutate(Parámetro = 'Original')
sim_alto_rtspmt <- fread('variedades_CEPV/PALMSIM_output_rootspecmaint0.00264.csv')%>%
mutate(Parámetro = 'Root specific maintenance = 0.00264')
sim_bajo_rtspmt <- fread('variedades_CEPV/PALMSIM_output_rootspecmaint0.00176.csv') %>%
mutate(Parámetro = 'Root specific maintenance = 0.00176')
sim_alto_mscfibpot <- fread('variedades_CEPV/PALMSIM_output_mesocarpfibpotmassfract0.28.csv')%>%
mutate(Parámetro = 'Mesocarp fiber potential mass fraction = 0.28')
sim_bajo_mscfibpot <- fread('variedades_CEPV/PALMSIM_output_mesocarpfibpotmassfract0.42.csv') %>%
mutate(Parámetro = 'Mesocarp fiber potential mass fraction = 0.42')
sim_alto_trkcnveff <- fread('variedades_CEPV/PALMSIM_output_trunkconveff0.828.csv')%>%
mutate(Parámetro = 'Trunk conversion efficiency = 0.828')
sim_bajo_trkcnveff <- fread('variedades_CEPV/PALMSIM_output_trunkconveff0.552.csv') %>%
mutate(Parámetro = 'Trunk conversion efficiency = 0.552')
sims <- rbind(sim_init, sim_alto_rtspmt, sim_bajo_rtspmt)
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
##### Grafico datos #####
sims_year <- sims %>%
group_by(Año = year(date), Parámetro) %>%
summarise(Rendimiento = sum(rendimiento_t_ha))
ggplot() +
geom_point(data = sims_year,
aes(x = Año, y = Rendimiento, color = Parámetro)) +
geom_line(data = sims_year,
aes(x = Año, y = Rendimiento, color = Parámetro)) +
labs(title = 'Variación de parámetros',
x = 'Año',
y = 'Rendimiento (t/ha)') +
theme_bw(base_size = 14,
base_family = 'Roboto Condensed') +
theme(legend.position = 'bottom',
legend.title = element_blank())
source("C:/Users/cbojaca/OneDrive - FEDEPALMA/palmsim-master/run_PALSIM_function.R", echo=TRUE)
source("C:/Users/cbojaca/OneDrive - FEDEPALMA/palmsim-master/run_PALSIM_function.R", echo=TRUE)
library(data.table)
library(Metrics)
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
##### Importar los datos #####
sim_init <- fread('variedades_CEPV/PALMSIM_output_modelo_original.csv') %>%
mutate(Parámetro = 'Original')
sim_alto_rtspmt <- fread('variedades_CEPV/PALMSIM_output_rootspecmaint0.00264.csv')%>%
mutate(Parámetro = 'Root specific maintenance = 0.00264')
sim_bajo_rtspmt <- fread('variedades_CEPV/PALMSIM_output_rootspecmaint0.00176.csv') %>%
mutate(Parámetro = 'Root specific maintenance = 0.00176')
sim_alto_mscfibpot <- fread('variedades_CEPV/PALMSIM_output_mesocarpfibpotmassfract0.28.csv')%>%
mutate(Parámetro = 'Mesocarp fiber potential mass fraction = 0.28')
sim_bajo_mscfibpot <- fread('variedades_CEPV/PALMSIM_output_mesocarpfibpotmassfract0.42.csv') %>%
mutate(Parámetro = 'Mesocarp fiber potential mass fraction = 0.42')
sim_alto_trkcnveff <- fread('variedades_CEPV/PALMSIM_output_trunkconveff0.828.csv')%>%
mutate(Parámetro = 'Trunk conversion efficiency = 0.828')
sim_bajo_trkcnveff <- fread('variedades_CEPV/PALMSIM_output_trunkconveff0.552.csv') %>%
mutate(Parámetro = 'Trunk conversion efficiency = 0.552')
sims <- rbind(sim_init, sim_alto_rtspmt, sim_bajo_rtspmt)
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
##### Grafico datos #####
sims_year <- sims %>%
group_by(Año = year(date), Parámetro) %>%
summarise(Rendimiento = sum(rendimiento_t_ha))
ggplot() +
geom_point(data = sims_year,
aes(x = Año, y = Rendimiento, color = Parámetro)) +
geom_line(data = sims_year,
aes(x = Año, y = Rendimiento, color = Parámetro)) +
labs(title = 'Variación de parámetros',
x = 'Año',
y = 'Rendimiento (t/ha)') +
theme_bw(base_size = 14,
base_family = 'Roboto Condensed') +
theme(legend.position = 'bottom',
legend.title = element_blank())
sims <- rbind(sim_init, sim_alto_rtspmt, sim_bajo_rtspmt,
sim_bajo_mscfibpot, sim_alto_mscfibpot)
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
##### Grafico datos #####
sims_year <- sims %>%
group_by(Año = year(date), Parámetro) %>%
summarise(Rendimiento = sum(rendimiento_t_ha))
ggplot() +
geom_point(data = sims_year,
aes(x = Año, y = Rendimiento, color = Parámetro)) +
geom_line(data = sims_year,
aes(x = Año, y = Rendimiento, color = Parámetro)) +
labs(title = 'Variación de parámetros',
x = 'Año',
y = 'Rendimiento (t/ha)') +
theme_bw(base_size = 14,
base_family = 'Roboto Condensed') +
theme(legend.position = 'bottom',
legend.title = element_blank())
0.64*0.8
source("C:/Users/cbojaca/OneDrive - FEDEPALMA/palmsim-master/run_PALSIM_function.R", echo=TRUE)
source("C:/Users/cbojaca/OneDrive - FEDEPALMA/palmsim-master/run_PALSIM_function.R", echo=TRUE)
library(data.table)
library(Metrics)
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
##### Importar los datos #####
sim_init <- fread('variedades_CEPV/PALMSIM_output_modelo_original.csv') %>%
mutate(Parámetro = 'Original')
sim_alto_rtspmt <- fread('variedades_CEPV/PALMSIM_output_rootspecmaint0.00264.csv')%>%
mutate(Parámetro = 'Root specific maintenance = 0.00264')
sim_bajo_rtspmt <- fread('variedades_CEPV/PALMSIM_output_rootspecmaint0.00176.csv') %>%
mutate(Parámetro = 'Root specific maintenance = 0.00176')
sim_alto_mscfibpot <- fread('variedades_CEPV/PALMSIM_output_mesocarpfibpotmassfract0.28.csv')%>%
mutate(Parámetro = 'Mesocarp fiber potential mass fraction = 0.28')
sim_bajo_mscfibpot <- fread('variedades_CEPV/PALMSIM_output_mesocarpfibpotmassfract0.42.csv') %>%
mutate(Parámetro = 'Mesocarp fiber potential mass fraction = 0.42')
sim_alto_trkcnveff <- fread('variedades_CEPV/PALMSIM_output_trunkconveff0.828.csv')%>%
mutate(Parámetro = 'Trunk conversion efficiency = 0.828')
sim_bajo_trkcnveff <- fread('variedades_CEPV/PALMSIM_output_trunkconveff0.552.csv') %>%
mutate(Parámetro = 'Trunk conversion efficiency = 0.552')
sims <- rbind(sim_init, sim_alto_rtspmt, sim_bajo_rtspmt,
sim_bajo_mscfibpot, sim_alto_mscfibpot,
sim_bajo_trkcnveff, sim_alto_trkcnveff)
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
##### Grafico datos #####
sims_year <- sims %>%
group_by(Año = year(date), Parámetro) %>%
summarise(Rendimiento = sum(rendimiento_t_ha))
ggplot() +
geom_point(data = sims_year,
aes(x = Año, y = Rendimiento, color = Parámetro)) +
geom_line(data = sims_year,
aes(x = Año, y = Rendimiento, color = Parámetro)) +
labs(title = 'Variación de parámetros',
x = 'Año',
y = 'Rendimiento (t/ha)') +
theme_bw(base_size = 14,
base_family = 'Roboto Condensed') +
theme(legend.position = 'bottom',
legend.title = element_blank())
View(sims_year)
palmsim <- function(clima_path, start_date, end_date, density = 143, dt = 1, latitude, soil_depth, soil_texture){
require(reticulate)
py_run_string("import pandas as pd")
py_run_string(paste("weather = pd.read_csv('", clima_path, "', index_col = 'Date')", sep = ""))
py_run_string("weather.index = pd.to_datetime(weather.index)")
py_run_string("from palmsim import PalmField")
py_run_string(paste0("pf = PalmField(year_of_planting = ", as.integer(year(start_date)),
", month_of_planting = ", as.integer(lubridate::month(start_date)),
", day_of_planting = ", as.integer(day(start_date)),
", planting_density = ", as.integer(density),
", dt = ", as.integer(dt),
", latitude = ", latitude,
", soil_depth = ", soil_depth,
", soil_texture_class = '", soil_texture, "')"))
# Couple the weather data
py_run_string("pf.weather.radiation_series = weather['solar (MJ/m2/day)']")
py_run_string("pf.weather.rainfall_series = weather['precip (mm/day)']")
py_run_string("pf.weather.temperature_series = weather['temperature (degC)']")
py_run_string("pf.weather.humidity_series = weather['humidity (%)']")
# Run the simulation
py_run_string(paste0("df = pf.run(duration = ",
as.integer(as.numeric(difftime(end_date, start_date, units = 'days'))), ")"))
df <- py$df
df$date <- ymd(df$date)
df$YAP <- df$YAP + (yday(df$date) / 365)
df$rendimiento_t_ha <- df$`generative_bunch_count_daily (1/ha/day)` * df$`generative_bunch_weight (kg)` / 1000
return(df)
}
sim_run <- palmsim(clima_path = "variedades_CEPV/ClimateData_Variedades_CEPV.csv",
start_date = ymd(20031001),
end_date = ymd(20191231),
density = 143,
dt = 1,
latitude = 6.98492,
soil_depth = 1.0,
soil_texture = "clay loam")
fwrite(sim_run, "variedades_CEPV/PALMSIM_output_rootspecmaint0.00264.csv")
library(data.table)
fwrite(sim_run, "variedades_CEPV/PALMSIM_output_rootspecmaint0.00264.csv")
library(data.table)
library(Metrics)
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
##### Importar los datos #####
sim_init <- fread('variedades_CEPV/PALMSIM_output_modelo_original.csv') %>%
mutate(Parámetro = 'Original')
sim_alto_rtspmt <- fread('variedades_CEPV/PALMSIM_output_rootspecmaint0.00264.csv')%>%
mutate(Parámetro = 'Root specific maintenance = 0.00264')
sim_bajo_rtspmt <- fread('variedades_CEPV/PALMSIM_output_rootspecmaint0.00176.csv') %>%
mutate(Parámetro = 'Root specific maintenance = 0.00176')
sim_alto_mscfibpot <- fread('variedades_CEPV/PALMSIM_output_mesocarpfibpotmassfract0.28.csv')%>%
mutate(Parámetro = 'Mesocarp fiber potential mass fraction = 0.28')
sim_bajo_mscfibpot <- fread('variedades_CEPV/PALMSIM_output_mesocarpfibpotmassfract0.42.csv') %>%
mutate(Parámetro = 'Mesocarp fiber potential mass fraction = 0.42')
sim_alto_trkcnveff <- fread('variedades_CEPV/PALMSIM_output_trunkconveff0.828.csv')%>%
mutate(Parámetro = 'Trunk conversion efficiency = 0.828')
sim_bajo_trkcnveff <- fread('variedades_CEPV/PALMSIM_output_trunkconveff0.552.csv') %>%
mutate(Parámetro = 'Trunk conversion efficiency = 0.552')
sims <- rbind(sim_init, sim_alto_rtspmt, sim_bajo_rtspmt,
sim_bajo_mscfibpot, sim_alto_mscfibpot,
sim_bajo_trkcnveff, sim_alto_trkcnveff)
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
##### Grafico datos #####
sims_year <- sims %>%
group_by(Año = year(date), Parámetro) %>%
summarise(Rendimiento = sum(rendimiento_t_ha))
ggplot() +
geom_point(data = sims_year,
aes(x = Año, y = Rendimiento, color = Parámetro)) +
geom_line(data = sims_year,
aes(x = Año, y = Rendimiento, color = Parámetro)) +
labs(title = 'Variación de parámetros',
x = 'Año',
y = 'Rendimiento (t/ha)') +
theme_bw(base_size = 14,
base_family = 'Roboto Condensed') +
theme(legend.position = 'bottom',
legend.title = element_blank())
View(sims_year)
library(data.table)
library(Metrics)
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
##### Importar los datos #####
sim_init <- fread('variedades_CEPV/PALMSIM_output_modelo_original.csv') %>%
mutate(Parámetro = 'Original')
sim_alto_rtspmt <- fread('variedades_CEPV/PALMSIM_output_rootspecmaint0.00264.csv')%>%
mutate(Parámetro = 'Root specific maintenance = 0.00264')
sim_bajo_rtspmt <- fread('variedades_CEPV/PALMSIM_output_rootspecmaint0.00176.csv') %>%
mutate(Parámetro = 'Root specific maintenance = 0.00176')
sim_alto_mscfibpot <- fread('variedades_CEPV/PALMSIM_output_mesocarpfibpotmassfract0.28.csv')%>%
mutate(Parámetro = 'Mesocarp fiber potential mass fraction = 0.28')
sim_bajo_mscfibpot <- fread('variedades_CEPV/PALMSIM_output_mesocarpfibpotmassfract0.42.csv') %>%
mutate(Parámetro = 'Mesocarp fiber potential mass fraction = 0.42')
sim_alto_trkcnveff <- fread('variedades_CEPV/PALMSIM_output_trunkconveff0.828.csv')%>%
mutate(Parámetro = 'Trunk conversion efficiency = 0.828')
sim_bajo_trkcnveff <- fread('variedades_CEPV/PALMSIM_output_trunkconveff0.552.csv') %>%
mutate(Parámetro = 'Trunk conversion efficiency = 0.552')
sims <- rbind(sim_init, sim_alto_rtspmt, sim_bajo_rtspmt,
sim_bajo_mscfibpot, sim_alto_mscfibpot,
sim_bajo_trkcnveff, sim_alto_trkcnveff)
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
##### Grafico datos #####
sims_year <- sims %>%
group_by(Año = year(date), Parámetro) %>%
summarise(Rendimiento = sum(rendimiento_t_ha))
ggplot() +
geom_point(data = sims_year,
aes(x = Año, y = Rendimiento, color = Parámetro)) +
geom_line(data = sims_year,
aes(x = Año, y = Rendimiento, color = Parámetro)) +
labs(title = 'Variación de parámetros',
x = 'Año',
y = 'Rendimiento (t/ha)') +
theme_bw(base_size = 14,
base_family = 'Roboto Condensed') +
theme(legend.position = 'bottom',
legend.title = element_blank())
